<!DOCTYPE html> 
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mon journal de bord</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 20px;
        }
        .question {
            margin: 20px 0;
        }
        button {     
            margin-top: 10px;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            background-color: #007BFF;
            color: white;
            border: none;
            border-radius: 5px;
        }
        button:hover {
            background-color: #0056b3;
        }
        .media-container {
            display: flex;
            justify-content: space-around;
            margin-top: 5px;
        }
        .media-section {
            width: 45%;
        }
        textarea {
            width: 80%;
            height: 100px;
            font-size: 16px;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #ccc;
            resize: none;
        }
        #selectedFiles {
            margin-top: 10px;
            font-size: 14px;
            color: #333;
        }
        #fileSavedMessage {
            color: green;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>Mon journal de bord</h1>
    
    <!-- Connexion Dropbox -->
    <button id="connect-dropbox">Se connecter √† Dropbox</button>
    <p id="dropbox-message"><strong>‚ÑπÔ∏è Vous devez √™tre connect√© √† votre Dropbox pour retrouver vos fichiers.</strong></p>

    <p id="dateDisplay"></p>

    <textarea id="journalEntry" placeholder="√âcrivez votre journal ici..."></textarea>
    <br>
    <button id="save-journal">Enregistrer mon journal</button>
    
    <h2>Fichiers √† t√©l√©charger</h2>     
    <label for="fileUpload">T√©l√©verser des fichiers (PDF, MAIL, SMS) :</label>
    <input type="file" id="fileUpload" accept=".pdf,.mal,.sms" multiple>
  
    <p id="selectedFiles"></p>
    <button id="save-file">Enregistrer mon fichier</button>

    <div class="media-container">
        <div class="media-section">
            <h2>üé• Vid√©o et üîä Audio d'urgence</h2>
            <div class="button-container">
                <button onclick="window.location.href='videos.html'">Vid√©o</button>
                <button onclick="window.location.href='audios.html'">Audio</button>
            </div>
        </div>
    </div>

    <h2>Synth√®se d‚Äôanalyse</h2>
    
</script>

<!-- G√©n√©ration du document Word -->

<p id="message">Avant de g√©n√©rer votre document, prenez un instant pour structurer les faits de mani√®re chronologique et pr√©cise. Un r√©cit bien organis√© facilite la compr√©hension de votre situation et renforce l'impact de votre dossier juridique.</p>
<ul>
    <li><strong>D√©crivez les faits dans l'ordre chronologique</strong> (du plus ancien au plus r√©cent).</li>
    <li><strong>Soyez pr√©cis</strong> : incluez des dates, lieux et personnes impliqu√©es.</li>
    <li><strong>Restez factuel</strong> : √©vitez les interpr√©tations et concentrez-vous sur les √©v√©nements.</li>
    <li><strong>Mentionnez les preuves</strong> (documents, SMS, mail, √©crits, t√©moignages, etc.).</li>
</ul>
<button id="generateButton">G√©n√©r√© un document Word</button>
<br>

<script src="https://cdn.jsdelivr.net/npm/docx@7.1.0/build/index.min.js"></script>
<script>
    document.getElementById("generateButton").addEventListener("click", function() {
        const { Document, Packer, Paragraph, TextRun } = window.docx;

        const doc = new Document({
            sections: [
                {
                    children: [
                        new Paragraph({ children: [new TextRun("Bienvenue sur ToxDetect.")] }),
                        new Paragraph({ children: [new TextRun("R√©cit des faits.")] }),
                        new Paragraph({ children: [new TextRun("Date de l‚Äô√©v√©nement : (Pi√®ce n¬∞...)")] }),
                        new Paragraph({ children: [new TextRun("Signature :")] }),
                        new Paragraph({ children: [new TextRun("P.S: Indiquer le nom des pi√®ces (Pi√®ces n¬∞...) :")] }),
                        
                    ],
                },
            ],
        });

        Packer.toBlob(doc).then((blob) => {
            const link = document.createElement("a");
            link.href = URL.createObjectURL(blob);
            link.download = "rapport.docx";
            link.click();
        });
    });
</script>

    <button id="open-dropbox-folder">Ouvrir mon dossier Dropbox</button>
    <br><br>

    <button onclick="window.location.href='index.html'">Retour √† l'accueil</button>

    <script src="journal.js"></script>
</body>
</html>
