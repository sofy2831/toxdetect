<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Journal ToxDetect</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dropbox.js/10.34.0/Dropbox-sdk.min.js"></script>
</head>
<body>
    <header>
        <h1>Mon Journal</h1>
        <button id="back-home" onclick="window.location.href='index.html'">Retour à l'accueil</button>
    </header>

    <main>
        <section>
            <h2 id="dateDisplay"></h2>
            <textarea id="journalEntry" placeholder="Écrivez votre journal ici..."></textarea>
            <button id="save-journal">Enregistrer sur Dropbox</button>
        </section>

        <section>
            <h2>Importer un fichier</h2>
            <input type="file" id="fileUpload" multiple>
            <button id="save-file">Enregistrer le fichier</button>
        </section>

        <section>
            <h2>Connexion Dropbox</h2>
            <button id="connect-dropbox">Se connecter à Dropbox</button>
        </section>
    </main>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const dateDisplay = document.getElementById("dateDisplay");
            const date = new Date().toLocaleDateString('fr-FR', { year: 'numeric', month: 'long', day: 'numeric' });
            dateDisplay.textContent = `Date du jour : ${date}`;
        });

        function extractAccessToken() {
            const params = new URLSearchParams(window.location.hash.substring(1));
            const token = params.get("access_token");

            if (token) {
                localStorage.setItem("dropboxToken", token);
                alert("Connexion Dropbox réussie !");
                window.location.href = "journal.html";
            }
        }

        window.onload = extractAccessToken;
    </script>

    <!-- Script pour Word -->
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    <script>
        Office.onReady(() => {
            console.log("Word prêt !");
        });

        function insertTextInWord() {
            Word.run(context => {
                const body = context.document.body;
                body.insertText("Mon journal ToxDetect", Word.InsertLocation.end);
                return context.sync();
            }).catch(error => console.error("Erreur Word :", error));
        }
    </script>

    <button onclick="insertTextInWord()">Insérer dans Word</button>
</body>
</html>
